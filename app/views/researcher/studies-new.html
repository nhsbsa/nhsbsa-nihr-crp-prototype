{% extends "layout.html" %}
{% block pageTitle %}Submit a new study{% endblock %}
{% block content %}
<div class="nhsuk-width-container">
  {% include "researcher/_signed-in-header.html" %}
  <div class="nhsuk-grid-row">
    {% include "researcher/_side-nav.html" %}
    <div class="nhsuk-grid-column-three-quarters">
      <h1 class="nhsuk-heading-xl">Submit a new study</h1>
      <form method="post" action="/researcher/studies/new" novalidate>
        <div class="nhsuk-form-group {{ errors.title ? 'nhsuk-form-group--error' : '' }}">
          <label class="nhsuk-label" for="title">Study title</label>
          {% if errors.title %}<span class="nhsuk-error-message">{{ errors.title }}</span>{% endif %}
          <input class="nhsuk-input" id="title" name="title" type="text" value="{{ values.title or '' }}">
        </div>

        <div class="nhsuk-form-group {{ errors.shortName ? 'nhsuk-form-group--error' : '' }}">
          <label class="nhsuk-label" for="shortName">Short name</label>
          {% if errors.shortName %}<span class="nhsuk-error-message">{{ errors.shortName }}</span>{% endif %}
          <input class="nhsuk-input" id="shortName" name="shortName" type="text" value="{{ values.shortName or '' }}">
        </div>

        <div class="nhsuk-form-group">
          <label class="nhsuk-label" for="studyType">Study type</label>
          <select class="nhsuk-select" id="studyType" name="studyType">
            <option value="">Select</option>
            <option value="Interventional" {% if values.studyType == 'Interventional' %}selected{% endif %}>Interventional</option>
            <option value="Observational" {% if values.studyType == 'Observational' %}selected{% endif %}>Observational</option>
          </select>
        </div>

        <div class="nhsuk-form-group">
          <label class="nhsuk-label" for="conditions">Conditions (comma separated)</label>
          <input class="nhsuk-input" id="conditions" name="conditions" type="text" value="{{ values.conditions or '' }}">
        </div>

        <div class="nhsuk-form-group {{ errors.targetRecruitmentDate ? 'nhsuk-form-group--error' : '' }}">
          <label class="nhsuk-label" for="targetRecruitmentDate">Target recruitment date (YYYY-MM-DD)</label>
          {% if errors.targetRecruitmentDate %}<span class="nhsuk-error-message">{{ errors.targetRecruitmentDate }}</span>{% endif %}
          <input class="nhsuk-input" id="targetRecruitmentDate" name="targetRecruitmentDate" type="text" value="{{ values.targetRecruitmentDate or '' }}">
        </div>

        <div class="nhsuk-form-group">
          <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">
              <label class="nhsuk-label" for="ageMin">Min age</label>
              <input class="nhsuk-input" id="ageMin" name="ageMin" type="number" value="{{ values.ageMin or 18 }}">
            </div>
            <div class="nhsuk-grid-column-one-half">
              <label class="nhsuk-label" for="ageMax">Max age</label>
              <input class="nhsuk-input" id="ageMax" name="ageMax" type="number" value="{{ values.ageMax or 80 }}">
            </div>
          </div>
        </div>

        <div class="nhsuk-form-group">
          <label class="nhsuk-label" for="geoMethod">Matching criteria (geo method)</label>
          <select class="nhsuk-select" id="geoMethod" name="geoMethod">
            <option value="distance" {% if values.geoMethod == 'distance' %}selected{% endif %}>Distance from site</option>
            <option value="region" {% if values.geoMethod == 'region' %}selected{% endif %}>Region</option>
          </select>
        </div>

        <div class="nhsuk-form-group">
          <label class="nhsuk-label" for="sitesCSV">Site information (one per line: Site,ODS,Email)</label>
          <textarea class="nhsuk-textarea" id="sitesCSV" name="sitesCSV" rows="5">{{ values.sitesCSV or '' }}</textarea>
        </div>

        <button class="nhsuk-button" data-module="nhsuk-button">Submit study</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
