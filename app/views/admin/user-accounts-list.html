{% extends "layout.html" %}
{% block pageTitle %}User accounts{% endblock %}

{% block content %}
<div class="nhsuk-width-container">

  {% include "admin/_signed-in-header.html" %}

  <div class="nhsuk-grid-row">
    {% include "admin/_side-nav.html" %}

    <div class="nhsuk-grid-column-three-quarters">
      <h1 class="nhsuk-heading-xl nhsuk-u-margin-bottom-2">{{ pageH1 or 'User accounts' }}</h1>
      <p class="nhsuk-body">You can view the full list of user accounts or use search to find specific accounts.</p>

      <div class="nhsuk-inset-text">
        <p>You have <strong>{{ pendingCount }}</strong> <strong>account requests</strong> to review.</p>
      </div>

      <!-- Keep original search styling -->
      <form role="search" method="get" action="/admin/users" class="nhsuk-search nhsuk-search--on-white nihr-search">
        <label class="nhsuk-u-visually-hidden" for="user-search">Search</label>
        <input class="nhsuk-search__input" id="user-search" name="q" type="search"
               placeholder="Search by name, organisation, email or role"
               value="{{ query or '' }}">
        <button class="nhsuk-search__submit" type="submit" aria-label="Search">
          <svg class="nhsuk-icon nhsuk-icon__search" xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M19.58 21l-5.63-5.63a7.5 7.5 0 111.41-1.41L21 19.58 19.58 21zM4 10a6 6 0 1012 0A6 6 0 004 10z"/>
          </svg>
        </button>
      </form>

      <p class="nhsuk-hint nhsuk-u-margin-top-1">Showing {{ shown or (items and items.length) or 0 }} of {{ totalAll or 0 }} results</p>

      {% if items and items.length %}
      <table class="nhsuk-table">
        <thead class="nhsuk-table__head">
          <tr class="nhsuk-table__row">
            <th scope="col" class="nhsuk-table__header">Name</th>
            <th scope="col" class="nhsuk-table__header">Organisation</th>
            <th scope="col" class="nhsuk-table__header">Submitted</th>
            <th scope="col" class="nhsuk-table__header">Type</th>
          </tr>
        </thead>
        <tbody class="nhsuk-table__body">
          {% for u in items %}
          <tr class="nhsuk-table__row">
            <td class="nhsuk-table__cell"><a href="/admin/users/{{ u.id }}">{{ u.title }} {{ u.firstName }} {{ u.lastName }}</a></td>
            <td class="nhsuk-table__cell">{{ u.org }}</td>
            <td class="nhsuk-table__cell">6 August 2025</td>
            <td class="nhsuk-table__cell">{{ u.role }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
        <p class="nhsuk-body">No users match your search.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
